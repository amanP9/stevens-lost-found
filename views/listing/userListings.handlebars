{{!-- TODO: Add Picture & Style it CSS--}}
{{!-- TODO: Get Rid Of "Unexpected end of JSON input on click of yes button in modal" --}}
{{!-- TODO: Verify the "Details" Button On Click --}}

<div class="listing-wrapper">
    {{#each itemsData}}
    <!-- Item Details -->
      <div class="item-listing">

  <div class="card">

  <div class="card-info">

        <!-- Item Description -->
        <div class="item-description">
          <span>{{this.type}}</span>
          <h1>{{this.name}}</h1>
          <p>{{this.description}}</p>
        </div>
  
        <!-- Dates -->
        <div class="item-dates">
          <p>{{this.createdAt}}</p>
          <p>{{this.dateLostOrFound}}</p>
  
        </div>
  
        <!-- Item Location -->
        <div class="item-location">
          <p>{{this.type}} Location: {{this.lostOrFoundLocation}}</p>
        </div>
      </div>
  
      </div>
  </div>
{{!-- </div> --}}

<!-- Trying If Statements For Setting itemAction and ItemActionString -->
  {{#ifEquals this.type "lost"}}
      <button id="modal-btn" class="button">Found</button> 
  
      <div id="modal" class="modal">
        <div class="modal-content">
          <div class="modal-header">
            <span class="close">&times;</span>
            <h2>{{this.name}}</h2>
          </div>
          <div class="modal-body">
            <p>Are you sure you have found this item?</p>
  {{/ifEquals}}

  {{#ifEquals this.type "found"}}
      <button id="modal-btn" class="button">Claim</button> 
  
      <div id="modal" class="modal">
        <div class="modal-content">
          <div class="modal-header">
            <span class="close">&times;</span>
            <h2>{{this.name}}</h2>
          </div>
          <div class="modal-body">
            <p>Are you sure this item is yours and you want to claim it?</p>
  {{/ifEquals}}
<!-- Trying If Statements For Setting itemAction and ItemActionString -->


            <button id="confirm-yes-btn" data-id="{{this._id}}" data-user="{{this.createdBy}}" class="button">Yes</button>
            <button id="confirm-no-btn" class="button">No</button>
  
            <p>Once you proceed with a yes, a confirmation email will be sent to
              the OP and the contact details of the OP will be shown.</p>
          </div>
          <div class="modal-footer">
            <h3>{{this.type}} Item</h3>
          </div>
        </div>
      </div>
  
      <div id="modal-inner" class="modal">
        <div class="modal-content">
          <div class="modal-header">
            <span class="close" id="close-btn-inner">&times;</span>
            <h2>{{this.name}}</h2>
          </div>
          <div class="modal-body">
            <button id="close-btn-inner-flat" class="button">Close</button>

          </div>
          <div class="modal-footer">
            <h3>An email to the OP has been sent for confirmation!</h3>
          </div>
        </div>
      </div>
  {{!-- Details Button --}}
      <button id="details-btn" class="button" data-button="{{this._id}}" data-user="{{this.createdBy}}">Details</button>

  {{!-- Edit Button --}}
      <button id="edit-btn" class="button" data-button="{{this._id}}">Edit</button>

  {{!-- Delete Button --}}
      <button onclick="document.getElementById('{{this._id}}').style.display='block'" class="button">Delete</button>
      <div id="{{this._id}}" class="modal">
      <span onclick="document.getElementById('{{this._id}}').style.display='none'" class="close" title="Close Modal">&times;</span>
      <form class="modal-content">
      <h1>Delete Listing?</h1>
      <p>Are you sure you want to delete this listing?</p>
      <div class="clearfix">
      <button type="button" id="close-this-modal" onclick="document.getElementById('{{this._id}}').style.display='none'" class="button">Cancel</button>
      <button id="delete-btn" class="button" data-button="{{this._id}}">Delete</button>
      </div>
      </form>
      </div>
    {{/each}}


{{!-- Modal For Successful Deletion --}}
{{#if itemDeleted}}
  <!-- Modal -->
<div id="success_tic" class="modal-fade" role="dialog">
<div class="modal-dialog">
<!-- Modal content-->
<div class="modal-content">
<button id="close-btn" data-dismiss="modal">&times;</button>
<div class="page-body">
<div class="head">  
<h3 style="margin-top:5px;">Listing Deleted Successfully!</h3>
</div>
{{!-- unclosed H1 for setting the check mark at center  --}}
<h1 style="text-align:center;"><div class="checkmark-circle">
<div class="background"></div>
<div class="checkmark draw"></div>
</div>
</div>
</div>
</div>
</div>
<script>
const modal = document.querySelector('#success_tic');
function openModal() {
modal.style.display = 'block'
}
openModal()
const closeBtn = document.querySelector('#close-btn');
closeBtn.addEventListener('click', closeModal);
function closeModal() {
  modal.style.display = 'none';
} </script>
{{/if}}

  </div>
<script src="/public/js/userListings.js" type="module"></script>
<link rel="stylesheet" href="/public/css/modal-styles.css" />
